# 업무일지

## 기본 정보
- 날짜: 2026-01-18 (토)
- 작성자: hexsera

## 진행 목표
핀볼 게임에 플리퍼 추가 및 각도 제한 기능 구현

## 진행 내용

| 작업 | 수정 파일 | 비고 |
|------|----------|------|
| 플리퍼 추가 PRD 작성 | PRD/pinball-플리퍼추가.md | PRD 스킬 사용 |
15분

| 플리퍼 World에 추가 | react/main/src/Pinball.jsx | leftFlipper, rightFlipper, Constraint 추가 |
| 플리퍼 이벤트 핸들러 구현 | react/main/src/Pinball.jsx | handleKeyDown/Up, handleTouchStart/End |
10분

테스트
10분

| 플리퍼 각도 제한 PRD 작성 | PRD/pinball-플리퍼각도제한.md | PRD 스킬 사용 |
10분

| 각도 제한 기능 구현 | react/main/src/Pinball.jsx | beforeUpdate 이벤트, 상태 변수 기반 제어 |
15분

학습
30분

**총 1시간 30분**
**학습 제외 1시간**

## 주요 변경 사항

### 1. 플리퍼 추가 (react/main/src/Pinball.jsx)
- leftFlipper, rightFlipper Bodies를 World.add()에 추가
- leftFlipperConstraint, rightFlipperConstraint 추가
- 키보드 이벤트: 좌/우 화살표키로 플리퍼 조작
- 터치 이벤트: 화면 좌/우 터치로 플리퍼 조작
- cleanup 함수에 이벤트 리스너 제거 추가

### 2. 플리퍼 각도 제한 기능 (react/main/src/Pinball.jsx)
- 각도 상수 정의
  - 왼쪽 플리퍼: -30도 ~ 0도 (라디안: -π/6 ~ 0)
  - 오른쪽 플리퍼: 0도 ~ 30도 (라디안: 0 ~ π/6)
- 키 누름 상태 변수 추가 (`isLeftKeyPressed`, `isRightKeyPressed`)
- beforeUpdate 이벤트로 매 프레임 속도 제어
  - 키 누름: 목표 각도까지 일정 속도로 회전
  - 키 떼면: 0도로 자동 복귀
- 각도 제한 강제 적용 (범위 초과 시 setAngle으로 보정)

## 이슈 및 해결

### 이슈 1: 플리퍼가 목표 각도까지 회전하지 않음
- **원인**: handleKeyDown이 한 번만 실행되어 setAngularVelocity가 한 번만 호출됨. 외력(공과 충돌)으로 속도가 변경되면 회전이 중단됨
- **해결**: 키 누름 상태 변수 도입, beforeUpdate 이벤트에서 매 프레임마다 속도를 설정하여 외력 영향 무시

### 이슈 2: 키를 떼도 플리퍼가 원위치로 복귀하지 않음
- **원인**: handleKeyUp에서 한 번만 속도를 설정하여 0도 도달 전에 속도가 변경될 수 있음
- **해결**: beforeUpdate 이벤트에서 키를 떼면 각도가 0도에 도달할 때까지 자동으로 속도를 설정하도록 구현

### 이슈 3: 키를 한번 누른 플리퍼가 계속 진동함
- **원인**: 모름

## 결과
- 상태: 완료
- 플리퍼가 키보드/터치로 정상 동작
- 플리퍼 각도 제한 (-30도 ~ 30도) 적용
- 키를 누르면 목표 각도까지 회전, 떼면 0도로 자동 복귀

## 다음 작업
- 플리퍼 진동 해결

