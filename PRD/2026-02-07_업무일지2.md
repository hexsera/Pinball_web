# 업무일지

## 기본 정보
- 날짜: 2026-02-07 (금)
- 작성자: hexsera

## 진행 목표
Dashboard.jsx의 회원정보 UI 컴포넌트를 재사용 가능한 독립 컴포넌트로 분리하여 Admin 페이지에서도 동일한 UI를 사용할 수 있도록 리팩토링

## 진행 내용

| 작업 | 수정 파일 | 비고 |
|------|----------|------|
| HeaderUserInfo 컴포넌트 생성 | frontend/src/components/HeaderUserInfo.jsx | Dashboard의 458~511줄 회원정보 UI 추출 |
| AdminHeader에 컴포넌트 배치 | frontend/src/admin/AdminHeader.jsx | Toolbar에 HeaderUserInfo 추가 |
| Dashboard 인라인 코드 교체 | frontend/src/Dashboard.jsx | 인라인 UI를 컴포넌트로 교체, 불필요한 상태/함수 제거 |
| 빌드 검증 | frontend/ | npm run build 성공 확인 |

**총 0시간 30분**

## 주요 변경 사항

### 1. HeaderUserInfo.jsx 생성

**추가:**
```jsx
import { useState } from 'react';
import { useNavigate } from 'react-router-dom';
import {
  Box, IconButton, Badge, Avatar, Typography,
  Button, Menu, MenuItem
} from '@mui/material';
import { Notifications, Mail } from '@mui/icons-material';
import { useAuth } from '../AuthContext';

function HeaderUserInfo() {
  const navigate = useNavigate();
  const { isLoggedIn, user, logout } = useAuth();

  const [anchorEl, setAnchorEl] = useState(null);
  const [avatarMenu, setAvatarMenu] = useState(false);

  function AvatarButtonClick(event) {
    setAnchorEl(event.currentTarget);
    setAvatarMenu(!avatarMenu);
  }

  function handleAvatarMenuClose() {
    setAnchorEl(null);
    setAvatarMenu(false);
  }

  function AvatarLogoutButton() {
    logout();
  }

  return (
    <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
      {isLoggedIn ? (
        <>
          <IconButton onClick={() => navigate('/admin')}>
            <Badge>
              <Notifications />
            </Badge>
          </IconButton>
          <IconButton>
            <Badge>
              <Mail />
            </Badge>
          </IconButton>
          <Button id="basic-button" onClick={AvatarButtonClick}>
            <Avatar sx={{ width: 40, height: 40, ml: 1 }}>U</Avatar>
            <Typography>{user.name}</Typography>
          </Button>
          <Menu
            anchorEl={anchorEl}
            onClose={handleAvatarMenuClose}
            id="user-menu"
            open={avatarMenu}
          >
            <MenuItem>프로필</MenuItem>
            <MenuItem onClick={() => AvatarLogoutButton()}>로그아웃</MenuItem>
          </Menu>
        </>
      ) : (
        <>
          <Button variant="contained" onClick={() => navigate('/login')}>
            로그인
          </Button>
          <Button variant="outlined" onClick={() => navigate('/Register')}>
            회원가입
          </Button>
        </>
      )}
    </Box>
  );
}

export default HeaderUserInfo;
```

**특징:**
- Dashboard.jsx의 458~511줄 회원정보 UI를 독립 컴포넌트로 분리
- AuthContext의 `isLoggedIn`, `user`, `logout`을 자체적으로 사용하여 props 없이 동작
- 로그인 상태에 따라 알림/메일 아이콘, 아바타 메뉴 또는 로그인/회원가입 버튼 표시
- `anchorEl`, `avatarMenu` 상태와 관련 함수를 컴포넌트 내부에 캡슐화

### 2. AdminHeader.jsx 수정

**변경 전:**
```jsx
import { AppBar, Toolbar, Box } from '@mui/material';

const drawerWidth = 260;

function AdminHeader() {
  return (
    <AppBar
      position="fixed"
      sx={{
        width: { sm: `calc(100% - ${drawerWidth}px)` },
        ml: { sm: `${drawerWidth}px` },
        backgroundColor: '#ffffffff',
        color: '#1f2937',
        boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',
        borderBottom: '1px solid #e5e7eb',
      }}
    >
      <Toolbar>

      </Toolbar>
    </AppBar>
  );
}
```

**변경 후:**
```jsx
import { AppBar, Toolbar, Box } from '@mui/material';
import HeaderUserInfo from '../components/HeaderUserInfo';

const drawerWidth = 260;

function AdminHeader() {
  return (
    <AppBar
      position="fixed"
      sx={{
        width: { sm: `calc(100% - ${drawerWidth}px)` },
        ml: { sm: `${drawerWidth}px` },
        backgroundColor: '#ffffffff',
        color: '#1f2937',
        boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',
        borderBottom: '1px solid #e5e7eb',
      }}
    >
      <Toolbar sx={{ justifyContent: 'flex-end' }}>
        <HeaderUserInfo />
      </Toolbar>
    </AppBar>
  );
}
```

**특징:**
- HeaderUserInfo import 추가 (`../components/HeaderUserInfo`)
- Toolbar에 `justifyContent: 'flex-end'` 스타일 추가하여 우측 정렬
- 비어있던 Toolbar에 HeaderUserInfo 컴포넌트 배치

### 3. Dashboard.jsx 수정

**변경 전 (import 부분):**
```jsx
import Pinball from './Pinball';
import UserInfo from './UserInfo';
import FriendPage from './FriendPage';
```

**변경 후 (import 부분):**
```jsx
import Pinball from './Pinball';
import UserInfo from './UserInfo';
import FriendPage from './FriendPage';
import HeaderUserInfo from './components/HeaderUserInfo';
```

**변경 전 (상태 부분):**
```jsx
const [openMenus, setOpenMenus] = useState({});
const [menuIndex, setMenuIndex] = useState(0);
const [anchorEl, setAnchorEl] = useState(null);
const [avatarMenu, setAvatarMenu] = useState(false);
```

**변경 후 (상태 부분):**
```jsx
const [openMenus, setOpenMenus] = useState({});
const [menuIndex, setMenuIndex] = useState(0);
```

**변경 전 (함수 부분):**
```jsx
function AvatarButtonClick (event)
{
  setAnchorEl(event.currentTarget);
  setAvatarMenu(!avatarMenu);
}

function handleAvatarMenuClose ()
{
  setAnchorEl(null);
  setAvatarMenu(false);
}

function AvatarLogoutButton()
{
  logout();
}
```

**변경 후 (함수 부분):**
```jsx
// 함수 제거됨 (HeaderUserInfo로 이동)
```

**변경 전 (JSX 부분, 458~511줄):**
```jsx
<Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>
  {isLoggedIn ? (
      <>
      <IconButton onClick={() => navigate('/admin')}>
    <Badge >
      <Notifications />
    </Badge>
  </IconButton>
  <IconButton>
    <Badge >
      <Mail />
    </Badge>
  </IconButton>
  <Button
    id="basic-button"
    onClick={AvatarButtonClick}
    >
    <Avatar sx={{ width: 40, height: 40, ml: 1 }}>U</Avatar>
    <Typography>
      {user.name}
    </Typography>
  </Button>
  <Menu
  anchorEl={anchorEl}
  onClose={handleAvatarMenuClose}
  id="user-menu"
  open={avatarMenu}
  >
    <MenuItem>
    프로필
    </MenuItem>
    <MenuItem
    onClick={()=>AvatarLogoutButton()}>
    로그아웃
    </MenuItem>
  </Menu>
      </>

  ) : (
      <>
      <Button
       variant="contained"
       onClick={()=>navigate('/login')}>
          로그인
      </Button>
      <Button
        variant="outlined"
        onClick={()=>navigate('/Register')}>
          회원가입
      </Button>
      </>
  )}

</Box>
```

**변경 후 (JSX 부분):**
```jsx
<HeaderUserInfo />
```

**특징:**
- 54줄의 인라인 회원정보 UI를 1줄의 컴포넌트 호출로 간소화
- `anchorEl`, `avatarMenu` 상태 제거 (HeaderUserInfo 내부로 이동)
- `AvatarButtonClick`, `handleAvatarMenuClose`, `AvatarLogoutButton` 함수 제거
- 코드 중복 제거 및 컴포넌트 재사용성 향상

## 컴포넌트 구조

**변경 전:**
```
Dashboard
└── AppBar
    └── Toolbar
        └── [458~511줄 인라인 회원정보 UI]

AdminPage
├── AdminHeader
│   └── AppBar
│       └── Toolbar (비어있음)
├── AdminSidebar
└── AdminMain
```

**변경 후:**
```
Dashboard
└── AppBar
    └── Toolbar
        └── HeaderUserInfo (컴포넌트)

AdminPage
├── AdminHeader
│   └── AppBar
│       └── Toolbar
│           └── HeaderUserInfo (컴포넌트)
├── AdminSidebar
└── AdminMain

HeaderUserInfo (독립 컴포넌트)
├── AuthContext 사용
├── react-router navigate 사용
└── 로그인 상태에 따른 UI 분기
    ├── 로그인: 알림, 메일, 아바타, 메뉴
    └── 비로그인: 로그인, 회원가입 버튼
```

## 결과
- 상태: 완료
- 빌드: 성공 (10.41s)

## 배운내용


## 다음 작업
- Dashboard 페이지에서 로그인/비로그인 상태별 UI 표시 테스트
- Admin 페이지(`/admin`)에서 회원정보 UI 표시 테스트
- Admin 페이지에서 로그아웃 기능 동작 테스트
- 브라우저에서 시각적 확인 및 기능 검증
