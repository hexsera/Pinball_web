# 업무일지

## 기본 정보
- 날짜: 2026-02-11 (수) 11:30~12:00 12:30~12:40
- 작성자: hexsera

## 진행 목표
AdminUserMain.jsx의 DataGrid에 회원 수정 기능을 위한 연필 아이콘 버튼을 추가하고, 버튼 클릭 시 Dialog 팝업을 띄우는 기능 구현 (TDD 방식)

## 진행 내용

| 작업 | 수정 파일 | 비고 |
|------|----------|------|
| RED: 실패 테스트 작성 (연필 버튼 렌더링) | `src/test/AdminUserMain.test.jsx` 생성 | DataGrid mock 사용 |
| RED: 실패 테스트 작성 (Dialog 팝업) | `src/test/AdminUserMain.test.jsx` | 버튼 클릭 → Dialog open |
| Vitest CSS 에러 해결 | `vite.config.js`, `src/test/setup.js` | DataGrid mock으로 우회, 임시 코드 청소 |
| GREEN: 연필 아이콘 버튼 + Dialog 구현 | `src/pages/admin/AdminUserMain.jsx` | 테스트 2개 통과 |
| 연필 아이콘 위치 변경 (오른쪽 끝) | `src/pages/admin/AdminUserMain.jsx` | actions 컬럼을 맨 뒤로 이동 |


## 주요 변경 사항

### 1. `src/test/AdminUserMain.test.jsx` 생성

**추가:**
```jsx
// DataGrid CSS 문제 우회: @mui/x-data-grid 전체 mock
vi.mock('@mui/x-data-grid', () => ({
  DataGrid: ({ rows, columns }) => (
    <table data-testid="data-grid">
      <tbody>
        {rows.map((row) => (
          <tr key={row.id}>
            {columns.map((col) => (
              <td key={col.field}>
                {col.renderCell
                  ? col.renderCell({ row })
                  : row[col.field]}
              </td>
            ))}
          </tr>
        ))}
      </tbody>
    </table>
  ),
}));

describe('AdminUserMain - 연필 아이콘 버튼', () => {
  it('각 레코드마다 연필 아이콘 버튼이 렌더링된다', async () => { ... });
  it('연필 아이콘 버튼 클릭 시 Dialog가 열린다', async () => { ... });
});
```

**특징:**
- `@mui/x-data-grid`가 내부적으로 `.css` 파일을 import하여 Vitest에서 에러 발생 → DataGrid 전체를 mock으로 교체하여 해결
- mock DataGrid는 `renderCell`을 지원하여 연필 버튼 렌더링 테스트 가능
- `axios`도 mock 처리하여 API 의존성 제거

### 2. `src/pages/admin/AdminUserMain.jsx` 수정

**변경 전:**
```jsx
const columns = [
  //{ field: 'id', headerName: 'ID', width: 70 },
  { field: 'email', headerName: '이메일', width: 200 },
  { field: 'nickname', headerName: '닉네임', width: 130 },
  { field: 'birth_date', headerName: '생년월일', width: 130 },
  { field: 'role', headerName: '역할', width: 100 },
];
```

**변경 후:**
```jsx
const columns = [
  { field: 'email', headerName: '이메일', width: 200 },
  { field: 'nickname', headerName: '닉네임', width: 130 },
  { field: 'birth_date', headerName: '생년월일', width: 130 },
  { field: 'role', headerName: '역할', width: 100 },
  {
    field: 'actions',
    headerName: '',
    width: 60,
    sortable: false,
    renderCell: (params) => (
      <IconButton
        aria-label="수정"
        size="small"
        onClick={() => handleEditClick(params.row)}
      >
        <EditIcon fontSize="small" />
      </IconButton>
    ),
  },
];
```

**특징:**
- `actions` 컬럼을 맨 오른쪽 끝에 배치
- 각 행마다 `EditIcon` 아이콘 버튼 렌더링
- 버튼 클릭 시 해당 row 데이터를 `selectedUser` 상태에 저장

**Dialog 추가:**
```jsx
// 상태 추가
const [editDialogOpen, setEditDialogOpen] = useState(false);
const [selectedUser, setSelectedUser] = useState(null);

// Dialog JSX
<Dialog open={editDialogOpen} onClose={handleDialogClose}>
  <DialogTitle>회원 수정</DialogTitle>
  <DialogContent>
    {selectedUser && (
      <Typography>
        {selectedUser.email} ({selectedUser.nickname})
      </Typography>
    )}
  </DialogContent>
  <DialogActions>
    <Button onClick={handleDialogClose}>닫기</Button>
  </DialogActions>
</Dialog>
```

### 3. `vite.config.js` 수정

**변경 전:**
```js
export default defineConfig({
  plugins: [react()],
  server: { ... },
});
```

**변경 후:**
```js
export default defineConfig({
  plugins: [react()],
  server: { ... },
  test: {
    environment: 'jsdom',
    setupFiles: ['./src/test/setup.js'],
  },
});
```

**특징:**
- Vitest 설정을 vite.config.js에 통합
- `jsdom` 환경으로 브라우저 DOM 시뮬레이션

## 결과
- 상태: 완료


## 배운 내용


## 다음 작업
