# 업무일지

## 기본 정보
- 날짜: 2026-01-29 (수요일) 11:10~11:52 12:50~1:30
- 작성자: hexsera

## 진행 목표
관리자의 회원관리를 위한 회원 목록 테이블 UI 구현

## 진행 내용

| 작업 | 수정 파일 | 비고 |
|------|----------|------|
| AdminUserPage, AdminUserMain 생성| AdminUserMain.jsx, AdminUserPage.jsx | |
| 라우트 추가 | react/main/src/App.jsx | /admin/users 경로 설정 |
| DataGrid 설치 | package.json | @mui/x-data-grid 패키지 설치 (사용자 수행) |
| 테이블 기능 구현 | react/main/src/admin/AdminUserMain.jsx | API 연동 및 DataGrid 추가 |
| 테스트 데이터 생성 | scratchpad/create_test_users.py | 임시 회원 30명 생성 스크립트 |

## 주요 변경 사항

### 2. react/main/src/admin/AdminUserMain.jsx 생성

**추가:**
```javascript
import { useState, useEffect } from 'react';
import { Box, Toolbar, Container, Typography } from '@mui/material';
import { DataGrid } from '@mui/x-data-grid';
import axios from 'axios';

const drawerWidth = 260;

// 테이블 컬럼 정의
const columns = [
  { field: 'id', headerName: 'ID', width: 70 },
  { field: 'email', headerName: '이메일', width: 200 },
  { field: 'nickname', headerName: '닉네임', width: 130 },
  { field: 'birth_date', headerName: '생년월일', width: 130 },
  { field: 'role', headerName: '역할', width: 100 },
];

function AdminUserMain() {
  const [users, setUsers] = useState([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const fetchUsers = async () => {
      try {
        const response = await axios.get('/api/v1/users', {
          headers: { 'X-API-Key': 'hexsera-secret-api-key-2026' }
        });
        setUsers(response.data);
      } catch (error) {
        console.error('회원 목록 조회 실패:', error);
      } finally {
        setLoading(false);
      }
    };
    fetchUsers();
  }, []);

  return (
    <Box
      component="main"
      sx={{
        flexGrow: 1,
        p: 3,
        width: { sm: `calc(100% - ${drawerWidth}px)` },
        backgroundColor: '#F9FAFB',
        minHeight: '100vh',
      }}
    >
      <Toolbar />
      <Container maxWidth="xl">
        <Typography variant="h5" sx={{ mb: 3, fontWeight: 'bold' }}>
          회원 관리
        </Typography>
        <Box sx={{ height: 600, width: '100%', backgroundColor: '#ffffff', borderRadius: 2, p: 2 }}>
          <DataGrid
            rows={users}
            columns={columns}
            loading={loading}
            pageSizeOptions={[10, 25, 50]}
            initialState={{ pagination: { paginationModel: { pageSize: 10 } } }}
            disableRowSelectionOnClick
          />
        </Box>
      </Container>
    </Box>
  );
}

export default AdminUserMain;
```

**특징:**
- useState로 users(회원 목록), loading(로딩 상태) 관리
- useEffect로 컴포넌트 마운트 시 FastAPI GET /api/v1/users 호출
- API Key 헤더 인증 포함 (X-API-Key: hexsera-secret-api-key-2026)
- DataGrid 페이지네이션 설정 (10, 25, 50개 단위)
- AdminMain.jsx와 동일한 레이아웃 스타일 적용

### 3. react/main/src/admin/AdminUserPage.jsx 생성

**추가:**
```javascript
import { Box } from '@mui/material';
import AdminHeader from './AdminHeader';
import AdminSidebar from './AdminSidebar';
import AdminUserMain from './AdminUserMain';

function AdminUserPage() {
  return (
    <Box sx={{ display: 'flex' }}>
      <AdminHeader />
      <AdminSidebar />
      <AdminUserMain />
    </Box>
  );
}

export default AdminUserPage;
```

**특징:**
- AdminPage.jsx 구조를 그대로 재현
- AdminHeader, AdminSidebar 컴포넌트 재사용
- Flexbox 레이아웃으로 3개 컴포넌트 조합

### 4. react/main/src/App.jsx 수정

**변경 전:**
```javascript
import AdminPage from './admin/AdminPage';

// ...

<Route path="/admin" element={<AdminPage/>} />
```

**변경 후:**
```javascript
import AdminPage from './admin/AdminPage';
import AdminUserPage from './admin/AdminUserPage';

// ...

<Route path="/admin" element={<AdminPage/>} />
<Route path="/admin/users" element={<AdminUserPage/>} />
```

**특징:**
- /admin/users 라우트 추가
- AdminUserPage 컴포넌트 import


## 아키텍처 구조

**컴포넌트 계층 구조:**
```
AdminUserPage
├── AdminHeader (재사용)
├── AdminSidebar (재사용)
└── AdminUserMain
    ├── Typography (제목: "회원 관리")
    └── DataGrid
        ├── columns (ID, 이메일, 닉네임, 생년월일, 역할)
        └── rows (FastAPI로부터 조회)
```

**데이터 흐름:**
```
AdminUserMain 마운트
       │
       ▼
useEffect 실행
       │
       ▼
axios.get('/api/v1/users')
       │
       ▼
FastAPI GET /api/v1/users
       │
       ▼
MySQL users 테이블 조회
       │
       ▼
응답 데이터 수신
       │
       ▼
setUsers(response.data)
       │
       ▼
DataGrid rows 업데이트
       │
       ▼
화면에 회원 목록 렌더링
```

## 결과
- 상태: 완료

## 배운내용
Datagrid 사용법 (기초)

## 다음 작업
- 회원 상세 정보 모달 구현 (행 클릭 시)
- 회원 삭제 기능 추가 (DELETE 버튼)
- 회원 검색/필터 기능 추가
- 회원 역할 변경 기능 추가 (user ↔ admin)
- AdminSidebar에 "회원 관리" 메뉴 항목 추가

---

## 기본 정보
- 날짜: 2026-01-29 (수요일) 1:50~3:00
- 작성자: hexsera

## 진행 목표
Dashboard 메인페이지에 한달 랭킹 TOP 10 테이블 추가

## 진행 내용

| 작업 | 수정 파일 | 비고 |
|------|----------|------|
| Table 컴포넌트 import | react/main/src/Dashboard.jsx | Material-UI Table 관련 컴포넌트 6개 추가 |
| 임시 랭킹 데이터 추가 | react/main/src/Dashboard.jsx | monthlyRankingData 배열 (10개 객체) |
| 랭킹 테이블 UI 구현 | react/main/src/Dashboard.jsx | mainele에 Paper + Table 추가 |

## 주요 변경 사항

### 2. react/main/src/Dashboard.jsx 수정 (1/3: Import)

**변경 전:**
```javascript
import {
  Box,
  Drawer,
  AppBar,
  Toolbar,
  List,
  Typography,
  IconButton,
  ListItem,
  ListItemButton,
  ListItemIcon,
  ListItemText,
  Container,
  Grid,
  TextField,
  InputAdornment,
  Avatar,
  Badge,
  Paper,
  CardMedia,
  Button,
  Menu,
  MenuItem
} from '@mui/material';
```

**변경 후:**
```javascript
import {
  Box,
  Drawer,
  AppBar,
  Toolbar,
  List,
  Typography,
  IconButton,
  ListItem,
  ListItemButton,
  ListItemIcon,
  ListItemText,
  Container,
  Grid,
  TextField,
  InputAdornment,
  Avatar,
  Badge,
  Paper,
  CardMedia,
  Button,
  Menu,
  MenuItem,
  Table,
  TableBody,
  TableCell,
  TableContainer,
  TableHead,
  TableRow
} from '@mui/material';
```

**특징:**
- Material-UI Table 관련 컴포넌트 6개 추가
- 테이블 구조: Table, TableContainer, TableHead, TableBody, TableRow, TableCell

### 3. react/main/src/Dashboard.jsx 수정 (2/3: 데이터)

**변경 전:**
```javascript
  );

  const mainele = (
```

**변경 후:**
```javascript
  );

  // 한달 랭킹 임시 데이터
  const monthlyRankingData = [
    { rank: 1, nickname: '핀볼마스터', score: 152000 },
    { rank: 2, nickname: '게임왕', score: 148500 },
    { rank: 3, nickname: '플리퍼킹', score: 145200 },
    { rank: 4, nickname: '점수사냥꾼', score: 138900 },
    { rank: 5, nickname: '핀볼러버', score: 135600 },
    { rank: 6, nickname: '고수', score: 128300 },
    { rank: 7, nickname: '챔피언', score: 125000 },
    { rank: 8, nickname: '도전자', score: 118700 },
    { rank: 9, nickname: '핀볼신', score: 112400 },
    { rank: 10, nickname: '초보탈출', score: 108100 }
  ];

  const mainele = (
```

**특징:**
- 임시 데이터 배열 10개 객체 생성
- 각 객체: rank(순위), nickname(닉네임), score(점수) 필드
- 점수 높은 순 정렬 (152,000 → 108,100)
- 추후 API 연동 시 이 부분만 수정하면 됨

### 4. react/main/src/Dashboard.jsx 수정 (3/3: UI)

**변경 전:**
```javascript
        </Paper>
        <Paper
            sx={{
                p: 3,

                boxShadow: '0 1px 3px rgba(0, 0, 0, 0.08)',
                border: '1px solid #e5e7eb',
            }}
            >
            <Typography variant="h6" fontWeight={600} gutterBottom>
                이번주 방문자 수
            </Typography>
            <CardMedia
                component="img"

                image="/images/graph.png"
                alt="로고"
                sx={{ marginBottom: 2, objectFit: 'contain' }}
            />

        </Paper>
```

**변경 후:**
```javascript
        </Paper>
        <Paper
            sx={{
                p: 3,
                boxShadow: '0 1px 3px rgba(0, 0, 0, 0.08)',
                border: '1px solid #e5e7eb',
            }}
            >
            <Typography variant="h6" fontWeight={600} gutterBottom>
                한달 랭킹 TOP 10
            </Typography>
            <TableContainer>
                <Table size="small">
                    <TableHead>
                        <TableRow>
                            <TableCell sx={{ fontWeight: 600 }}>순위</TableCell>
                            <TableCell sx={{ fontWeight: 600 }}>닉네임</TableCell>
                            <TableCell sx={{ fontWeight: 600 }} align="right">점수</TableCell>
                        </TableRow>
                    </TableHead>
                    <TableBody>
                        {monthlyRankingData.map((row) => (
                            <TableRow key={row.rank}>
                                <TableCell>{row.rank}</TableCell>
                                <TableCell>{row.nickname}</TableCell>
                                <TableCell align="right">{row.score.toLocaleString()}</TableCell>
                            </TableRow>
                        ))}
                    </TableBody>
                </Table>
            </TableContainer>
        </Paper>
        <Paper
            sx={{
                p: 3,

                boxShadow: '0 1px 3px rgba(0, 0, 0, 0.08)',
                border: '1px solid #e5e7eb',
            }}
            >
            <Typography variant="h6" fontWeight={600} gutterBottom>
                이번주 방문자 수
            </Typography>
            <CardMedia
                component="img"

                image="/images/graph.png"
                alt="로고"
                sx={{ marginBottom: 2, objectFit: 'contain' }}
            />

        </Paper>
```

**특징:**
- "이번주 방문자 수" Paper 앞에 랭킹 테이블 Paper 삽입
- TableContainer로 테이블 감싸기 (스크롤 지원)
- Table size="small"로 컴팩트한 테이블 생성
- TableHead에 순위, 닉네임, 점수 컬럼 헤더 (fontWeight: 600)
- TableBody에 monthlyRankingData.map()으로 10개 행 렌더링
- toLocaleString()으로 점수에 천단위 콤마 표시 (152,000)
- align="right"로 점수 컬럼 우측 정렬

## 아키텍처 구조

**Dashboard 메인페이지 Paper 구성:**
```
mainele (Grid container)
├── Paper 1: 게임하기 버튼
├── Paper 2: 한달 랭킹 TOP 10 (신규 추가)
│   └── Table
│       ├── TableHead (순위, 닉네임, 점수)
│       └── TableBody (10개 행)
├── Paper 3: 이번주 방문자 수 그래프
└── Paper 4: 월간 최고 기록 그래프
```

**Table vs DataGrid 선택 근거:**
```
요구사항 분석
     │
     ├─ 데이터 양: 10개 행 (소량)
     ├─ 사용자 상호작용: 없음 (정렬/필터/편집 불필요)
     ├─ 구현 복잡도: 단순 표시만 필요
     │
     ▼
Table 선택 ✅
     │
     ├─ 장점: 추가 설치 불필요, 가벼움, 간단한 코드
     ├─ 무료: MIT 라이선스
     └─ 일관성: Dashboard의 다른 MUI 컴포넌트와 통일
```

## 결과
- 상태: 완료

## 배운내용
- Table 사용법
- Table 과 DataGrid 차이점

## 다음 작업
- FastAPI 랭킹 조회 API 구현 (GET /api/v1/scores/ranking)
- Dashboard.jsx에서 임시 데이터를 API 호출로 교체
- 점수 조회 API 구현 (GET /api/v1/scores/user/{user_id})
- Pinball.jsx에서 게임 종료 시 점수 저장 API 연동
